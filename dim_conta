SELECT Cta_Codigo,sum(dco_valor) as dco_valor ,
case when Cta_Codigo IN ('11130602',
'11130603',
'11130604',
'13135401',
'11130605',
'11130606',
'11130607',
'11130608',
'11130609',
'11130610',
'11130611',
'11130612',
'11130613',
'11130614',
'11130615',
'11130616',
'11130617',
'11130618',
'11130619',
'11130620',
'11130621',
'11130622',
'11130623',
'11130624',
'11130625') then 'Cartera'
when Cta_Codigo IN (
'21110401',
'21110402',
'21110403',
'21110404',
'21110405',
'21110406',
'21110407',
'21110408',
'21110409',
'21110410',
'21110411',
'21110412',
'21110413',
'21110414',
'21110415',
'21110416',
'21110417',
'21110418',
'21110419',
'21110420',
'21110421',
'21110422',
'21110423',
'21110424',
'21110425'
) then 'Retencion'
else 'Protesto' end as tipo,
'D' as mov
FROM Comprobante
INNER JOIN Detalle_Comprobante ON Detalle_Comprobante.Tdc_Tipo = Comprobante.Tdc_Tipo AND Comprobante.Tdc_Tipo = Detalle_Comprobante.Tdc_Tipo 
AND Comprobante.Com_Numero = Detalle_Comprobante.Com_Numero AND Comprobante.Com_Periodo = Detalle_Comprobante.Com_Periodo
WHERE Cta_Codigo IN ('11130602',
'11130603',
'11130604',
'13135401',
'11130605',
'11130606',
'11130607',
'11130608',
'11130609',
'11130610',
'11130611',
'11130612',
'11130613',
'11130614',
'11130615',
'11130616',
'11130617',
'11130618',
'11130619',
'11130620',
'11130621',
'11130622',
'11130623',
'11130624',
'11130625',
'21110401',
'21110402',
'21110403',
'21110404',
'21110405',
'21110406',
'21110407',
'21110408',
'21110409',
'21110410',
'21110411',
'21110412',
'21110413',
'21110414',
'21110415',
'21110416',
'21110417',
'21110418',
'21110419',
'21110420',
'21110421',
'21110422',
'21110423',
'21110424',
'21110425',
'11135601',
'11135701'
)
and Dco_TipoDH = 'D'
AND Comprobante.Com_Fecha >= '20230101'
AND Comprobante.Com_Fecha <= '20231231'
GROUP BY Cta_Codigo
UNION 
SELECT Cta_Codigo,sum(dco_valor) as dco_valor ,
case when Cta_Codigo IN ('11130602',
'11130603',
'11130604',
'13135401',
'11130605',
'11130606',
'11130607',
'11130608',
'11130609',
'11130610',
'11130611',
'11130612',
'11130613',
'11130614',
'11130615',
'11130616',
'11130617',
'11130618',
'11130619',
'11130620',
'11130621',
'11130622',
'11130623',
'11130624',
'11130625') then 'Cartera'
when Cta_Codigo IN (
'21110401',
'21110402',
'21110403',
'21110404',
'21110405',
'21110406',
'21110407',
'21110408',
'21110409',
'21110410',
'21110411',
'21110412',
'21110413',
'21110414',
'21110415',
'21110416',
'21110417',
'21110418',
'21110419',
'21110420',
'21110421',
'21110422',
'21110423',
'21110424',
'21110425'
) then 'Retencion'
else 'Protesto' end as tipo,
'H' as mov
FROM Comprobante
INNER JOIN Detalle_Comprobante ON Detalle_Comprobante.Tdc_Tipo = Comprobante.Tdc_Tipo AND Comprobante.Tdc_Tipo = Detalle_Comprobante.Tdc_Tipo 
AND Comprobante.Com_Numero = Detalle_Comprobante.Com_Numero AND Comprobante.Com_Periodo = Detalle_Comprobante.Com_Periodo
WHERE Cta_Codigo IN ('11130602',
'11130603',
'11130604',
'13135401',
'11130605',
'11130606',
'11130607',
'11130608',
'11130609',
'11130610',
'11130611',
'11130612',
'11130613',
'11130614',
'11130615',
'11130616',
'11130617',
'11130618',
'11130619',
'11130620',
'11130621',
'11130622',
'11130623',
'11130624',
'11130625',
'21110401',
'21110402',
'21110403',
'21110404',
'21110405',
'21110406',
'21110407',
'21110408',
'21110409',
'21110410',
'21110411',
'21110412',
'21110413',
'21110414',
'21110415',
'21110416',
'21110417',
'21110418',
'21110419',
'21110420',
'21110421',
'21110422',
'21110423',
'21110424',
'21110425',
'11135601',
'11135701'
)
and Dco_TipoDH = 'H'
AND Comprobante.Com_Fecha >= '20230101'
AND Comprobante.Com_Fecha <= '20231231'
GROUP BY Cta_Codigo
